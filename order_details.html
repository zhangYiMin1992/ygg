<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="style/basic.css">
    <link rel="stylesheet" type="text/css" href="style/index.css">
    <meta name="Keywords" content="订单详情页面">
    <meta name="description" content="订单详情页面">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta property="qc:admins" content="2275617726564116375">
    <meta http-equiv="Cache-Control" content="no-transform ">
    <meta name="applicable-device" content="mobile">
    <meta name="viewport" content="minimal-ui=yes,width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
</head>

<body>
    <div class=" wrap page page-current">
        <!-- 头部 -->
        <div class="con_top" id="conTop" data-header="scroll">
            <div class="top_menu open-panel" data-panel=".panel-left"><span>2</span></div>
            <div class="top_logo"> </div>
            <div class="search" id="search"></div>
        </div>
        <div id="order_details_page" class="order_list_pt"></div>
        <!-- 内容部分 -->
         <!--  <div class="order_list order_list_pt">
               <ul>
                     <li>
                        <div class="order_mes clearfix">
                            <div class="order_num">订单号：<span>00000000000000</span> ></div>
                            <div class="state"><a>待收货</a></div>
                        </div>
                        <dl class="order clearfix">
                            <dt>卖家：<a href="javascript:;" class="shop">艺高高直营店</a></dt>
                            <dd>
                                <a href="javascript:;" class="clearfix">
                                    <div class="order_pic"><img src="images/01.jpg"></div>
                                    <div class="order_message">
                                        <p>外面的世界</p>
                                        <p class="pic_type">水彩<span class="line">|</span>小春哥<span class="line">|</span>25*37cm<span class="line">|</span>2016</p>
                                        <p>原创艺术品</p>
                                        <em class="o_price">￥25000.00元</em>
                                    </div>
                                    <div class="refund refund_btn">退款</div>
                                </a>
                            </dd>
                        </dl> 
                        <dl class="order clearfix">
                            <dt>卖家：<a href="javascript:;" class="shop">小卖部</a></dt>
                            <dd>
                                <a href="javascript:;" class="clearfix">
                                    <div class="order_pic"><img src="images/01.jpg"></div>
                                    <div class="order_message">
                                        <p>外面的世界</p>
                                        <p class="pic_type">水彩<span class="line">|</span>小春哥<span class="line">|</span>25*37cm<span class="line">|</span>2016</p>
                                        <p>原创艺术品</p>
                                        <em class="o_price">￥25000.00元</em>
                                    </div>
                                    <div class="refund">已退款</div>
                                </a>
                            </dd>
                            <dd>
                                <a href="javascript:;" class="clearfix">
                                    <div class="order_pic"><img src="images/01.jpg"></div>
                                    <div class="order_message">
                                        <p>外面的世界</p>
                                        <p class="pic_type">水彩<span class="line">|</span>小春哥<span class="line">|</span>25*37cm<span class="line">|</span>2016</p>
                                        <p>原创艺术品</p>
                                        <em class="o_price">￥25000.00元</em>
                                    </div>
                                    <div class="refund">已退款</div>
                                </a>
                            </dd>
                        </dl>        
                    </li>
                </ul> 
            </div>-->
            <!-- 个人信息部分 -->
            <!-- <div class="city">
                <ul>
                    <li>下单时间:
                        <input class="receive_time" id="receiveTime" type="text" value="2017/5/12" readonly="readonly">
                    </li>
                    <li>姓&#12288;&#12288;名:
                        <input class="receive_contact" id="receiveContact" type="text" readonly="readonly">
                    </li>
                    <li>联系方式:
                        <input class="receive_cellPhone" id="receiveCellPhone" type="tel" readonly="readonly">
                    </li>
                    <li>联系地址:
                        <input class="distSelect_event"  id="distSelectEvent" type="text" readonly="readonly">
                    </li>   
                    <li>备&#12288;&#12288;注:
                        <input class="receive_message"  id="receiveMessage" type="text"  readonly="readonly" >  
                    </li> 
                    <li>支付方式:
                        <input readonly="readonly">
                    </li>  
                </ul>
                <a class="weixin pay_method"><span>微信钱包</span></a>
            </div> -->
        <!-- </div> -->
    </div>


    <!-- 侧边栏 -->
  
    <!-- 侧边栏结束-->

    <textarea style="display: none" id="orderDetailsTmpl">
        <div class="order_list">
            <ul>
            
                    <%for(od in this){%>
                        <li class="order_list_li">
                            <div class="order_mes clearfix">
                                <div class="order_num">订单号：<span><%od.split("m")[1].split("#")[0]%></span> ></div>
                                <div class="state"><a><%orderStatus[od.split("#")[1]]%></a></div>
                            </div>
                            <%$.each(this[od],function(k2,v2){%>
                                <%for(nm in v2){%>
                                    <dl class="order clearfix">
                                        <dt>卖家：<a href="javascript:;" class="shop"><%nm%></a></dt>
                                        <%$.each(v2[nm],function(k3,v3){%>
                                            <dd>
                                                <a href="javascript:;" class="clearfix">
                                                    <div class="order_pic"><img src="http://www.artgogo.com<%v3.Photo%>" onerror="this.onerror=null;this.src='./images/load.jpg';"></div>
                                                    <div class="order_message">
                                                        <p><%v3.goods_name%></p>
                                                        <p class="pic_type"><%v3.artwork.pinlei%><span class="line">|</span><%v3.artwork.name%><span
                                                                class="line">|</span><%v3.artwork.width%>*<%v3.artwork.height%>cm<span class="line">|</span><%v3.artwork.czsj%></p>
                                                        <p>原创艺术品</p>
                                                        <em class="o_price">￥<%v3.artwork.price%>.00元</em>
                                                    </div>
                                                    <div class="refund"><%v3.orderStatus%></div>
                                                </a>
                                            </dd>
                                            <%if(!orderInfo.address){%>
                                            <div style="display: none;">
                                                <%orderInfo.address=v3.address%><!-- 收货地址 -->
                                                <%orderInfo.add_time=v3.add_time%><!-- 下单时间 -->
                                                <%orderInfo.buyer_name=v3.buyer_name%><!-- 收货姓名 -->
                                                <%orderInfo.mobile=v3.mobile%><!-- 联系电话 -->
                                                <%orderInfo.buy_notes=v3.buy_notes%><!--  买家备注 -->
                                                <%orderInfo.pay_method=payMethod[v3.pay_method]%><!--  支付方式 -->
                                                <%orderInfo.payClass=payClass[v3.pay_method]%><!--  -->
                                            </div>
                                            <%}%>
                                        <%});%>
                                    </dl>
                                <%}%>
                            <%});%>
                        </li>
                    <%}%>
       
            </ul>
        </div>

    </textarea>

</body>
<script src='./js/basic.js'></script>
<script src='./js/index.js'></script>
<script>
var orderStatus={
    "1":"待付款",
    "2":"待收货",
    "3":"已完成",
    "4":"退款／售后"
};
var payMethod={
    "1":"支付宝",
    "2":"银联",
    "3":"财付通",
    "4":"微信支付",
    "5":"现金支付",
    "6":"pos机付款",
    "7":"银行转账"
};

var payClass={
    "1":"zhifubao",
    "2":"bank",
    "4":"weixin"
};


var orderInfo={};
$(function(){
    var order=getParam().orderId;
    $.ajax({
        type: "POST",
        dataType: "json",
        url: "/api/newwap/order/getOrderBySN",
        data: {
            order_sn:order
        },
        success:function(res){
            var orderDetailsDom=document.createDocumentFragment();
            $.YGG.tmpl({dom: $(orderDetailsDom), v: $('#orderDetailsTmpl').val(), datas: res});
            $('#order_details_page').get(0).appendChild(orderDetailsDom);
            var html='<div class="city"><ul><li>下单时间:<input class="receive_time" id="receiveTime" type="text" value="'+orderInfo.add_time+'" readonly="readonly"></li><li>姓&#12288;&#12288;名:<input class="receive_contact" id="receiveContact" type="text" value="'+orderInfo.buyer_name+'" readonly="readonly"></li><li>联系方式:<input class="receive_cellPhone" id="receiveCellPhone" type="tel" value="'+orderInfo.mobile+'"  readonly="readonly"></li><li>联系地址:<input class="distSelect_event"  id="distSelectEvent" type="text" value="'+orderInfo.address+'"  readonly="readonly"></li><li>备&#12288;&#12288;注:<input class="receive_message"  id="receiveMessage" type="text" value="'+orderInfo.buy_notes+'"  readonly="readonly" ></li> <li>支付方式: <input readonly="readonly" > </li></ul><a class="'+orderInfo.payClass+' pay_method"><span>'+orderInfo.pay_method+'</span></a></div>'
            $('#order_details_page').append(html);
            change();
            setRefund();
        }
    });
    $('#order_details_page').on('click','.refund_btn',function(){
        window.location.href="refund.html";
    });
});
function getParam() {
    var t = location.search
      , e = new Object;
    if (-1 != t.indexOf("?")) {
        var n = t.substr(1);
        strs = n.split("&");
        for (var i = 0; i < strs.length; i++)
            e[strs[i].split("=")[0]] = strs[i].split("=")[1]
    }
    return e
}

var setRefund=function(){
    var $dd=$('.order dd');
    if($('.state a').html()=='待收货'){
        $('.refund').css('display','block');
    }
    for(var i=0;i<$dd.length;i++){
        if($dd.eq(i).find($('.refund')).html()=='待收货'){
            $dd.eq(i).find($('.refund')).html('退款');
            $dd.eq(i).find($('.refund')).addClass('refund_btn');
        }
    }   
};

</script>
</html>