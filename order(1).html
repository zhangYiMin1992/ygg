
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="style/basic.css">
    <link rel="stylesheet" type="text/css" href="style/index.css">
    <meta name="Keywords" content="后台订单页面">
    <meta name="description" content="后台订单页面">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta property="qc:admins" content="2275617726564116375">
    <meta http-equiv="Cache-Control" content="no-transform ">
    <meta name="applicable-device" content="mobile">
    <meta name="viewport" content="minimal-ui=yes,width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
</head>

<body>
    <div class="wrap page page-current">
        <div class="con_top" id="conTop" data-header="scroll">
            <div class="top_menu open-panel" data-panel=".panel-left"><span>2</span></div>
            <div class="top_logo"> </div>
            <div class="search" id="search"></div>
        </div>
        <!-- 内容部分 -->
        <div class="order_page">
         <!-- 订单列表 -->
            <div class="nav-tab-top">
                <ul class="clearfix"> 
                    <li class="cur" id="all"><a href="javascript:;">全部</a></li>
                    <li data-code="waitPay" ><a href="javascript:;">待付款</a></li>
                    <li data-code="waitSend" ><a href="javascript:;">待收货</a></li>
                    <li data-code="waitConfirm"><a href="javascript:;">已完成</a></li>
                    <li data-code="waitRate" ><a href="javascript:;">退款/售后</a></li> 
                </ul> 
            </div>
            <ul class="order_con_list">
                <li class="" style="display: block" ><div class="order_list"><ul id="all_order"></ul></div></li>
                <li>代付款</li>
                <li>待收货</li>
                <li>已完成</li>
                <li>退款/售后</li>
            </ul>
            <!-- 订单内容结束 -->
            <!-- <div class="order_list">
                <ul>
                    <li>
                        <div class="order_mes clearfix">
                            <div class="order_num">订单号：<span>12345678901234</span> ></div>
                            <div class="state non_payment"><a>立即支付</a></div>
                        </div>
                        <dl class="order clearfix">
                            <dt>卖家：<a href="javascript:;" class="shop">艺高高直营店</a></dt>
                            <dd>
                                <a href="javascript:;" class="clearfix">
                                    <div class="order_pic"><img src="images/01.jpg"></div>
                                    <div class="order_message">
                                        <p>外面的世界</p>
                                        <p class="pic_type">水彩<span class="line">|</span>小春哥<span class="line">|</span>25*37cm<span class="line">|</span>2016</p>
                                        <p>原创艺术品</p>
                                       <em class="o_price">￥25000.00元</em>
                                    </div>
                                </a>
                            </dd>
                        </dl>        
                    </li>

                     <li>
                        <div class="order_mes clearfix">
                            <div class="order_num">订单号：<span>00000000000000</span> ></div>
                            <div class="state"><a>待发货</a></div>
                        </div>
                        <dl class="order clearfix">
                            <dt>卖家：<a href="javascript:;" class="shop">艺高高直营店</a></dt>
                            <dd>
                                <a href="javascript:;" class="clearfix">
                                    <div class="order_pic"><img src="images/01.jpg"></div>
                                    <div class="order_message">
                                        <p>外面的世界</p>
                                        <p class="pic_type">水彩<span class="line">|</span>小春哥<span class="line">|</span>25*37cm<span class="line">|</span>2016</p>
                                        <p>原创艺术品</p>
                                       <em class="o_price">￥25000.00元</em>
                                    </div>
                                </a>
                            </dd>
                        </dl> 
                        <dl class="order clearfix">
                            <dt>卖家：<a href="javascript:;" class="shop">小卖部</a></dt>
                            <dd>
                                <a href="javascript:;" class="clearfix">
                                    <div class="order_pic"><img src="images/01.jpg"></div>
                                    <div class="order_message">
                                       <p>外面的世界</p>
                                        <p class="pic_type">水彩<span class="line">|</span>小春哥<span class="line">|</span>25*37cm<span class="line">|</span>2016</p>
                                        <p>原创艺术品</p>
                                       <em class="o_price">￥25000.00元</em>
                                    </div>
                                </a>
                            </dd>
                            <dd>
                                <a href="javascript:;" class="clearfix">
                                    <div class="order_pic"><img src="images/01.jpg"></div>
                                    <div class="order_message">
                                        <p>外面的世界</p>
                                        <p class="pic_type">水彩<span class="line">|</span>小春哥<span class="line">|</span>25*37cm<span class="line">|</span>2016</p>
                                        <p>原创艺术品</p>
                                       <em class="o_price">￥25000.00元</em>
                                    </div>
                                </a>
                            </dd>
                        </dl>        
                    </li>
                </ul>
            </div> -->

        </div>
         <!-- 内容部分 -->
    </div>
    <textarea id="orderTmpl1" style="display: none;">
    <!-- 不是同一个订单编号 -->
        <!-- $.each(this,function(k,v){ -->
            <%for(var i=0,len=this.length;i<len;i++){%>
            <li>
                 <div class="order_mes clearfix">
                     <div class="order_num">订单号：<span><%this[i].order_sn%></span> ></div>
                     <div class="state non_payment"><a><%this[i].orderStatus%></a></div>
                 </div>
                 <dl class="order clearfix">
                     <dt>卖家：<a href="javascript:;" class="shop"><%this[i].m_name%></a></dt>
                     <dd>
                         <a href="javascript:;" class="clearfix">
                             <div class="order_pic"><img lazyload="http://www.artgogo.com<%this[i].Photo%>"></div>
                             <div class="order_message">
                                 <p><%this[i].Title%></p>
                                 <p class="pic_type"><%this[i].pinlei%><span class="line">|</span><%this[i].name%><span class="line">|</span><%this[i].width%>*<%this[i].height%>cm<span class="line">|</span><%this[i].czsj%></p>
                                 <p>原创艺术品</p>
                                <em class="o_price">￥<%this[i].order_payment%>.00元</em>
                             </div>
                         </a>
                     </dd>
                 </dl>        
             </li>
            <%}%>
    </textarea>
   <textarea id="orderTmpl2" style="display: none;">
    <!-- 是同一个订单编号但不是同一个店铺名称-->
            <li>
                 <div class="order_mes clearfix">
                     <div class="order_num">订单号：<span><%res.order_sn%></span> ></div>
                     <div class="state non_payment"><a><%res.orderStatus%></a></div>
                 </div>
                <!--   <%for(var i=0,len=res.length;i<len;i++){%>
                 <dl class="order clearfix">
                     <dt>卖家：<a href="javascript:;" class="shop"><%this[i].m_name%></a></dt>
                     <dd>
                         <a href="javascript:;" class="clearfix">
                             <div class="order_pic"><img lazyload="http://www.artgogo.com<%this[i].Photo%>"></div>
                             <div class="order_message">
                                 <p><%this[i].Title%></p>
                                 <p class="pic_type"><%this[i].pinlei%><span class="line">|</span><%this[i].name%><span class="line">|</span><%this[i].width%>*<%this[i].height%>cm<span class="line">|</span><%this[i].czsj%></p>
                                 <p>原创艺术品</p>
                                <em class="o_price">￥<%this[i].order_payment%>.00元</em>
                             </div>
                         </a>
                     </dd>
                 </dl> 
                 <%}%>        -->
             </li>
            
    </textarea> 

</body>
<script src='./js/basic.js'></script>
<script src='./js/index.js'></script>
<script>
  $(function(){
    LazyLoad.Run({
                 isImgCenter: true
             });
    if($('#all').attr('class')=='cur'){
        
         $.ajax({
              type: "POST",
              dataType: "json",
              url:"/newwap/order/getTestOrders",
              data:{
              index:1,
              size:4
              },
              success:function(res){

                    //把所有的订单号都取出来
                    for(var i=0;i<res.length;i++){
                        var arr=[];
                        for(var j=0;j<res.length;j++){
                            arr.push(res[j].order_sn);
                        }
                    }
                    var arrSn=[]; 
                    findSame(arr,arrSn);//取出订单号一样的订单
                    for(var i=0;i<res.length;i++){
                        // console.log(res[i].order_sn);
                        if(arrSn.length!=0 && res[i].order_sn==arrSn[0]){//判断有没有订单号一样的订单
                           var tempDom=document.createDocumentFragment();
                           $.YGG.tmpl({dom: $(tempDom), v: $('#orderTmpl1').val(), datas:res});
                           $('#all_order').get(0).appendChild(tempDom);
                           console.log(res);
                           
                        }
                    }
                    
               
              

              }
        });
    }
 });
function findSame(Arr,arr) {
    // Arr.sort();
    for (var i = 0; i < Arr.length - 1; i++) {
        if (Arr[i] == Arr[i + 1]) {
            arr.push(Arr[i]);
            return true;
        }
    };
    return false;
};
</script>

</html>