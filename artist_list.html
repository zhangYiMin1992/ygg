<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="style/basic.css">
    <link rel="stylesheet" type="text/css" href="style/artist_list.css">
    <meta name="Keywords" content="艺术家列表页面">
    <meta name="description" content="艺术家列表页面">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta property="qc:admins" content="2275617726564116375">
    <meta http-equiv="Cache-Control" content="no-transform ">
    <meta name="applicable-device" content="mobile">
    <meta name="viewport" content="minimal-ui=yes,width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
</head>

<body>
    <div class="wrap page page-current">
        <div class="con_top" id="conTop" data-header="scroll">
            <div class="top_menu open-panel" data-panel=".panel-left"><span>2</span></div>
            <div class="top_logo"> </div>
            <div class="search" id="search"></div>
        </div>
        <div class="artist_list"  data-module="wrapper-ablum">
            <div class="rec_title">
                <div class="rec">
                    <span>相关推荐</span>
                </div>
            </div>
            <div class="artist_rec">
                <div class="artists">
                    <div class="artist_box">
                        <span class="artist_img"><img src="images/art_details_pic.jpg"></span>
                        <span class="artist_name">小春哥</span>
                        <span class="zan">6655次赞</span>
                        <span class="line">|</span>
                        <span class="num">30件作品</span>
                    </div>
                </div>
                <div class="art_book_box" data-module='hscroll'>
                    <ul class="art_book">
                        <li>
                            <a href="javascript:;"><img lazyload='images/09.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/10.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/07.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/05.jpg'></a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="artist_rec">
                <div class="artists">
                    <div class="artist_box">
                        <span class="artist_img"><img src="images/art_details_pic.jpg"></span>
                        <span class="artist_name">小春哥</span>
                        <span class="zan">6655次赞</span>
                        <span class="line">|</span>
                        <span class="num">30件作品</span>
                    </div>
                </div>
                <div class="art_book_box" data-module='hscroll'>
                    <ul class="art_book">
                        <li>
                            <a href="javascript:;"><img lazyload='images/09.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/10.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/07.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/05.jpg'></a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="artist_rec">
                <div class="artists">
                    <div class="artist_box">
                        <span class="artist_img"><img src="images/art_details_pic.jpg"></span>
                        <span class="artist_name">小春哥</span>
                        <span class="zan">6655次赞</span>
                        <span class="line">|</span>
                        <span class="num">30件作品</span>
                    </div>
                </div>
                <div class="art_book_box" data-module='hscroll'>
                    <ul class="art_book">
                        <li>
                            <a href="javascript:;"><img lazyload='images/09.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/10.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/07.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/05.jpg'></a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="artist_rec">
                <div class="artists">
                    <div class="artist_box">
                        <span class="artist_img"><img src="images/art_details_pic.jpg"></span>
                        <span class="artist_name">小春哥</span>
                        <span class="zan">6655次赞</span>
                        <span class="line">|</span>
                        <span class="num">30件作品</span>
                    </div>
                </div>
                <div class="art_book_box" data-module='hscroll'>
                    <ul class="art_book">
                        <li>
                            <a href="javascript:;"><img lazyload='images/09.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/10.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/06.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/07.jpg'></a>
                        </li>
                        <li>
                            <a href="javascript:;"><img lazyload='images/05.jpg'></a>
                        </li>
                    </ul>
                </div>
            </div>
            <a class="ad" data-module="ad">
                <!-- <img lazyload='http://www.artgogo.com<%this[this.length-1].big_photo%>'> -->
                <img src="images/08.jpg">
            </a>
            <div id="artistCon"></div>
        </div>
    </div>
    <!-- 侧边栏 -->
    <div class="panel-overlay"></div>
    <div class="panel left_sidebar panel-left" id="leftSidebar">
        <dl>
            <dt class="list_bck1">首页</dt>
        </dl>
        <dl>
            <dt class="list_bck2">中国爱艺术</dt>
        </dl>
        <dl>
            <dt class="list_bck3">万人展</dt>
        </dl>
        <dl class="select">
            <dt class="list_bck4">发现艺术</dt>
            <dd> <a href="javascript:;"> | 艺术介入服务</a> <a href="javascript:;"> | 艺术能量供应</a> </dd>
        </dl>
        <dl class="select">
            <dt class="list_bck5">艺术x品牌</dt>
            <dd> <a href="javascript:;"> | 艺术介入服务</a> <a href="javascript:;"> | 艺术能量供应</a> </dd>
        </dl>
        <dl class="select">
            <dt class="list_bck6">艺术品</dt>
            <dd> <a href="javascript:;"> | 艺术介入服务</a> <a href="javascript:;"> | 艺术能量供应</a> </dd>
        </dl>
        <dl class="select">
            <dt class="list_bck7">艺术家</dt>
            <dd> <a href="javascript:;"> | 艺术介入服务</a> <a href="javascript:;"> | 艺术能量供应</a> </dd>
        </dl>
        <dl>
            <dt class="list_bck8">关于我们</dt>
        </dl>
        <dl class="noline">
            <dt class="list_bck9">个人中心<span>2</span></dt>
        </dl>
    </div>
    <!-- 侧边栏结束-->
      <textarea id="artistList"  style="display: none;">
            <%for(var i=0,len=this.length;i<len;i++){%>
            <div class="artist_rec">
                <div class="artists">
                    <div class="artist_box">
                        <span class="artist_img"><img lazyload='http://www.artgogo.com<%this[i].Photo%>'></span>
                        <span class="artist_name"><%this[i].Title%></span>
                        <span class="zan"><%this[i].attention%>次赞</span>
                        <span class="line">|</span>
                        <span class="num"><%this[i].artnums%>件作品</span>
                    </div>
                </div>
                <div class="art_book_box" data-module='hscroll'>
                     <ul class="art_book"> 
                         <%$.each(this[i].artworks,function(index,value){%>
                             <li>
                                 <a href="newwap/artwork/detail?artworkId=<%value.id%>"><img lazyload="http://www.artgogo.com<%value.cover%>"></a>
                             </li>
                         <%});%>
                     </ul>
                </div>
            </div>
      <%}%>
      </textarea>
</body>
<script src='../js/basic.js'></script>
<script src='../js/index.js'></script>
<script type="text/javascript">
// 简单的节流函数
function throttle(func, wait, mustRun) {
    var timeout,
            startTime = new Date();

    return function () {
        var context = this,
                args = arguments,
                curTime = new Date();

        clearTimeout(timeout);
        // 如果达到了规定的触发时间间隔，触发 handler
        if (curTime - startTime >= mustRun) {
            func.apply(context, args);
            startTime = curTime;
            // 没达到触发间隔，重新设定定时器
        } else {
            timeout = setTimeout(func, wait);
        }
    };
}
function loading($el){
    return $(window).height()+$(window).scrollTop()>$el.offset().top
}
var curIndex=1;
var adIndex=1;
;$(function(){
    function realFun(){
        var $el;
        var $wa = curIndex == 1 ? $('[data-module=ad]') : $('#artistCon');
        if ($wa.last().attr('data-module')=='ad') {
            $el=$wa.last();
        } else {
            $el = $wa.last().children().last();
        }
        if(loading($el)){
            curIndex++;
             $.YGG.ajax({
                    type:'get',
                    url:'newwap/artist/getArtist',
                    data:{
                        index:curIndex,
                        size:5
                    },
                    success:function(res){
                        var artistTmpl=document.createDocumentFragment();
                        $.YGG.tmpl({dom: $(artistTmpl), v: $('#artistList').val(), datas: res});
                        $('#artistCon').get(0).appendChild(artistTmpl);
                        adIndex++;
                        // console.log($('#artistList'));
                         $.ajax({
                                type:'get',
                                url: 'newwap/index_content/getContent',
                                data: {
                                    index:adIndex,
                                    size:1
                                },
                                success:function(res){
                                    var html='<a class="ad" data-module="ad"><img lazyload="http://www.artgogo.com'+res.Photo+'"></a>';
                                    $('#artistCon').append(html);   
                                }
                         });
                    }
                });
        }
    };
     window.addEventListener('scroll', throttle(realFun, 500, 1000));    
});

$(function(){
    LazyLoad.Run({
        isImgCenter:true
    });
});
</script>
</html>
